box: clojure:latest

build:
  steps:
    - script:
      name: install-nodejs
      code: |
        curl -sL https://deb.nodesource.com/setup_7.x | bash -
        apt-get install -y nodejs build-essential

    - script:
      name: test-client
      code: |
        cd webclient && make test

    - script:
      name: test-app
      code: |
        cd my-stories && lein test

assemble:
  steps:
    - script:
      name: create-jar
      code: make server

    - script:
      name: create-image
      code: echo "docker build . :)"
